@let XS = responsive.isXs();
@let SM = responsive.isSm();
@let MD = responsive.isMd();
@let LG = responsive.isLg();
@let XL = responsive.isXl();

<section [ngClass]="'relative flex flex-col h-auto w-full mb-[30px]!'">
  @for (content of contents(); track i; let i = $index) {
    <h2 [ngClass]="'text-[1.7em] font-bold mt-[20px]! mb-[20px]! ml-2.5 truncate'"> {{ content.sectionTitle }}</h2>
    <div [ngClass]="'relative w-full'">
      @if (isCarousel()) {
        <div [ngClass]="'absolute h-full w-full'">
          <div [ngClass]="'flex items-end justify-between p-[0px_10px]! h-full'">
            <button [ngClass]="'arrow'" [disabled]="!canScroll(i)" (click)="void navigateCarrousel('left', i)">
              <fa-icon [icon]="faArrowLeft"></fa-icon>

            </button>

            <button [ngClass]="'arrow'" [disabled]="!canScroll(i)" (click)="void navigateCarrousel('right', i)">
              <fa-icon [icon]="faArrowRight"></fa-icon>

            </button>

          </div>

        </div>

      }
      <div #items [ngClass]="{
        'carousel': true,
        'grid-flow-col': isCarousel(),
        'grid-flow-row gap-y-[50px]': !isCarousel(),

      }"
      [ngStyle]="{
        'grid-auto-columns': (XL) ? '185px' : (LG) ? '180px' : (MD) ? '170px' : (SM) ? '160px' : '120px',
        'grid-template-columns': (isCarousel()) ? 'none' :
                                  (XL) ? 'repeat(5, 1fr)' :
                                    (LG) ? 'repeat(4, 1fr)' : 'repeat(3, 1fr)',

        'column-gap': (XL) ? 'calc((100% - (5 * 185px)) / 4)' :
                      (LG) ? 'calc((100% - (4 * 180px)) / 3)' :
                      (MD) ? 'calc((100% - (3 * 170px)) / 2)' :
                      (SM) ? 'calc((100% - (3 * 160px)) / 2)' : 'calc((100% - (3 * 120px)) / 2)'

      }">
        @for (item of content.items; track item.id) {
          <div [ngClass]="'flex flex-col gap-[5px]'" [ngStyle]="{
            'width':  (XL) ? '185px' :
                      (LG) ? '180px' :
                      (MD) ? '170px' :
                      (SM) ? '160px' : '120px'

          }">
            <div
              [ngClass]="'bg-gray-500 w-full rounded-[20px] transition hover:transform-[scale(1.05)] active:transform-[scale(1.05)] cursor-pointer'" [ngStyle]="{
                'height': (XL) ? '265px' :
                          (LG) ? '260px' :
                          (MD) ? '250px' :
                          (SM) ? '230px' : '200px'

              }"
              (click)="void navigateContent(item.title)"

              >

             <img
              [src]="item.imagesUrl[0]"
              [attr.width]="185"
              [attr.height]="265"
              [ngClass]="'h-full w-full rounded-[20px]'"
              [alt]="item.title"

              >

            </div>

            <div [ngClass]="'flex justify-between w-full mt-[15px]!'">
              <p [ngClass]="'text-[#a9a9a9] text-[0.9em]'">{{ item.year }}</p>
              <span [ngClass]="'inline-flex justify-between w-[38px]'">
                <img [ngClass]="'h-[15px] w-[15px]'" [src]="star" [alt]="'estrela'">
                <p [ngClass]="'text-[#a9a9a9] text-[0.9em] ml-1.5'">{{ item.rating | number:'1.1-1':'pt-BR' }}</p>

              </span>

            </div>

            <h2 [ngClass]="'font-medium'" [ngStyle]="{ 'font-size': (XS || SM) ? '1.1em' : '1.3em' }">{{ item.title }}</h2>
            @if ('seasons' in item) {
              <p [ngClass]="'text-[#a9a9a9] text-[0.9em] font-[600]'">Temp. {{ item.seasons }}</p>

            }

          </div>

        }
        @empty {
          <div [ngClass]="'no-content'">
            <div [ngClass]="'flex items-center justify-center w-[80px] h-[80px] rounded-full bg-gray-800'">
              <fa-icon [icon]="faSearch" [ngClass]="'text-[2rem] text-gray-500'"></fa-icon>

            </div>

            <h3 [ngClass]="'text-[1.5em] font-bold'">
              Nenhum resultado encontrado

            </h3>

            <p [ngClass]="'text-[1em] max-w-[320px]'">
              Não encontramos nenhum título que corresponda à sua pesquisa.

            </p>

          </div>

        }

      </div>

    </div>

  }
  @empty {
    <div [ngClass]="'flex flex-col items-center justify-center w-full h-[280px] gap-4 text-center text-gray-400 select-none'">
      <div [ngClass]="'flex items-center justify-center w-[80px] h-[80px] rounded-full bg-gray-800'">
        <fa-icon [icon]="faBoxOpen" [ngClass]="'text-[2rem] text-gray-500'"></fa-icon>

      </div>

      <h3 [ngClass]="'text-lg font-semibold'">
        Nenhum conteúdo disponível

      </h3>

      <p [ngClass]="'text-sm max-w-[320px]'">
        No momento não há itens para exibir nesta seção.

      </p>

    </div>

  }

</section>
